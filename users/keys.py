import base64

from Crypto.Cipher import PKCS1_OAEP
from Crypto.PublicKey import RSA

from config import PRIVATE_KEY
PRIVATE_KEY = "-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAwZDPsmRqJphiAhanzrufBZgM0MecLz9UFA3vSEklErjPBFHR\nenFHOT2EyE9ge6NiOHTs9v3yujoAaa72zpjFz8ar7UK2WR1K2onTCE29MYm0JI24\n/cl62DYhV1fV4lOPpPZ6rykwu9hxQLdODyDiG0V73BLciZnsZvzjpy9Ja9sJPHJd\nYD0cLBOda2u2RXVw7WlIpMdp7I0pCredUeDF7883I1yelG/imUcoEy7E8bvffXSa\nvcUNbSu75PXdOketaEpNwNbaRqpNoN2+93RMgtt3cdE5SjKASt7ITqNp4glf2U1o\npesxtVtq2MZhIIL4/d/Vm7e53EDDZ10UOZMkUQIDAQABAoIBAAjwfdobl3gtt5GI\nf7KdUUFcMcPS4yp+sIyuTdGrIJ9gKf3lZDD1IjShW+R3H4HoRFcOhdrclLEfcIFQ\n/XiiPzj6wDoQd5zPHLPR841Fr1YWSau6QJvWajIp8lFfBuuJX8f+4uC77JJxUx4p\ntQz/cBfRtkAePiGL+noxZddk2H2GyxnJcnCpy2gvKQhkiaHU7dVmJ+3MToP4l7Nc\nSaZtz/zOn/OkVZzIXT3h4q1mCe0hYTIE1AiHPjs497KS5v0SP08bXC7hXqbzRxhH\nDY7/06/3ta2D3sF+XqukR1PRKvz/Z3Yr2QdFcZcQ8hFFk3FwbwkSWp1LexO8Sf+x\ne/T0FgECgYEA7F3QvgBMXnVFNFH9bArlpLtrURwBp3+KHlzo+gUdxF3lZc0FGy34\nilDg5KRRK2dLyfgZltuIXb0kDGy0cQDqyk35+x3ZopV+PwPZL5ReWIjYe77iwe1r\n23N7n989t/BC0fIX5T8NV5ZrDF6A2ykLa6ZBG5RnBldAiO/ai8MxalECgYEA0aTd\nI0ObagSNNkcPwhM59eBiB7bZYy90SqcKrG/6HMS7UDZnekFwBXD+KmpWj1xjrQ0J\nhF0cGGrlDQ9w10eBQafK8iWCRWopaleLEXUfKslcIpJAttH30bHXzudHz+zIqr/b\np9XnDoCFam7HD9vUfM/ACSr5UaARSeNz0w1dmgECgYAo1YRMbszCvMu54DhBxBgs\nP1yo5Ie8oiIAYNi26M9dr0MENUkeivCXJKXVmjWTpALJ35y8HS0P1K83nkgGBbyK\nOrJnGZ8RoXXv+QA6Yg1yiiGsLywJiLTLcsX2tqB4+H7yujo6lov9h7TyrBjiw9J/\nRHeXBipORCCYB6ff4VbWIQKBgGUAPqH8smVzZ+0cc1UXGjeBMPlyeG02sZo9vACz\nuhYeGfhdHaFi4WtdsrYQoT9UTZlTzJ/+k8iXx15xb/XntzhAdKAQviBfMzDOmGuC\nt89PT5pAR/lMU06tlcFS3+Amvc61vEex4C22cZCDalgTmt2+4VAJajCPI4UrleO6\nbrwBAoGAOhH/Ik+NHPZI4Dc6AD43LwGTHMmwP4T/qtoEHx4dcqrugYAYyuGRCsPz\nTqahdUozgEduKRxsLl39LfZIEI3yD4o7p8gbjplEGs6HmrqJh8pZVYLUpSWSr0Aq\nQ3DaX+8Gs0zShfZRVYiS2wzaVorV0OCsgBWyqfy7hgZaN6XhJIM=\n-----END RSA PRIVATE KEY-----"

def decrypt_message(encrypted_message):
    private_key = RSA.import_key(PRIVATE_KEY.encode('utf-8'))
    cipher = PKCS1_OAEP.new(private_key)
    encrypted_bytes = base64.b64decode(encrypted_message)
    decrypted = cipher.decrypt(encrypted_bytes)
    return decrypted.decode('utf-8')
